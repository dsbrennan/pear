{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://github.com/dsbrennan/pear/schema/scenario.json",
    "type": "object",
    "title": "PEAR Schema: Scenario object",
    "description": "The JSON schema to control a Scenario object within the PEAR dataset",
    "definitions": {
        "reference": {
            "type": "string",
            "pattern": "^[1-9][0-9]*\\.[1-9][0-9]*\\.[1-9][0-9]*\\.[2-9][0-9]*$"
        }
    },
    "properties": {
        "name": {
            "type": "object",
            "title": "Name of the Scenario Object",
            "description": "The identification labels of the scenario object within the parent dataset",
            "required": [
                "reference",
                "label"
            ],
            "properties": {
                "reference": {
                    "allOf": [
                        {
                            "$ref": "#/definitions/reference"
                        },
                        {
                            "title": "Numeric reference",
                            "description": "This is the concatenated value of the dataset category number, the dataset subtype number, the parent dataset number and the incremental number of the scenario within the dataset. The minimum value for the scenario number is .2, so the reference would be 1.1.1.2"
                        }
                    ]
                },
                "label": {
                    "type": "string",
                    "title": "Text reference",
                    "description": "This is a combination of the feature, the target, and the application. i.e displacement-superstructure-point-load",
                    "minLength": 11
                }
            },
            "additionalProperties": false
        },
        "description": {
            "$ref": "dataset.json#/properties/description"
        },
        "authors": {
            "$ref": "dataset.json#/properties/authors"
        },
        "dates": {
            "$ref": "dataset.json#/properties/dates"
        },
        "lineage": {
            "type": "object",
            "title": "Lineage links",
            "description": "A link to the scenario which this scenario supersedes and link to the scenario which supersedes this scenario",
            "properties": {
                "supersedes": {
                    "allOf": [
                        {
                            "$ref": "#/definitions/reference"
                        },
                        {
                            "title": "Superseded scenario",
                            "description": "The numberical reference of the scenario supersedes by this scenario"
                        }
                    ]
                },
                "precedes": {
                    "allOf": [
                        {
                            "$ref": "#/definitions/reference"
                        },
                        {
                            "title": "Preceded scenario",
                            "description": "The numberical reference of the scenario precedes this scenario"
                        }
                    ]
                }
            },
            "minProperties": 1,
            "additionalProperties": false
        },
        "commands": {
            "type": "array",
            "title": "List of available commands",
            "description": "A list of the available commands and associated arguments to generate the PEAR objects associated files listed in the output section",
            "items": {
                "type": "object",
                "title": "Command object",
                "description": "Details of an available command and associated arguments",
                "required": [
                    "label",
                    "command"
                ],
                "properties": {
                    "label": {
                        "$ref": "dataset.json#/properties/commands/items/properties/label"
                    },
                    "command": {
                        "$ref": "dataset.json#/properties/commands/items/properties/command"
                    },
                    "arguments": {
                        "$ref": "dataset.json#/properties/commands/items/properties/arguments"
                    },
                    "parameters": {
                        "type": "array",
                        "title": "A list of system parameters",
                        "description": "A description of the system parameters that effect the processed input files that generate the output files",
                        "items": {
                            "type": "object",
                            "title": "Parameter object",
                            "description": "Details of the internal system parameters which are in operation that effect the input files and generate the output files",
                            "required": [
                                "name",
                                "description",
                                "explanation",
                                "selection"
                            ],
                            "properties": {
                                "name": {
                                    "$ref": "dataset.json#/properties/commands/items/properties/parameters/items/properties/name"
                                },
                                "description": {
                                    "$ref": "dataset.json#/properties/commands/items/properties/parameters/items/properties/description"
                                },
                                "explanation": {
                                    "$ref": "dataset.json#/properties/commands/items/properties/parameters/items/properties/explanation"
                                },
                                "selection": {
                                    "$ref": "dataset.json#/properties/commands/items/properties/parameters/items/properties/selection"
                                }
                            },
                            "additionalProperties": false
                        },
                        "minItems": 1
                    }
                },
                "additionalProperties": false
            },
            "minItems": 1
        },
        "executed": {
            "$ref": "dataset.json#/properties/executed"
        },
        "inputs": {
            "type": "array",
            "title": "Input files",
            "description": "A list of input files used by the scenario",
            "items": {
                "type": "object",
                "title": "Input file object",
                "description": "An input file to the scenario",
                "required": [
                    "reference",
                    "files"
                ],
                "properties": {
                    "reference": {
                        "type": "string",
                        "title": "Numeric reference",
                        "description": "PEAR object reference",
                        "pattern": "^[1-9][0-9]*\\.[1-9][0-9]*\\.[1-9][0-9]*(\\.[0-9]+)?$"
                    },
                    "files": {
                        "$ref": "dataset.json#/definitions/standardFile/properties/files"
                    }
                },
                "additionalProperties": false
            },
            "minItems": 1
        },
        "outputs": {
            "type": "array",
            "title": "Output files",
            "description": "A list of output files generated by the scenario",
            "items": {
                "allOf": [
                    {
                        "type": "object",
                        "title": "Output file object",
                        "description": "A output file generated by the scenario",
                        "required": [
                            "name",
                            "type",
                            "files"
                        ],
                        "properties": {
                            "name": {
                                "type": "string",
                                "title": "Name",
                                "description": "The output file name",
                                "minLength": 1
                            },
                            "type": {
                                "type": "string",
                                "title": "Type",
                                "description": "Type of the output file (PBSHM Schema or Other)"
                            },
                            "files": {
                                "type": "array",
                                "title": "Output files",
                                "description": "A list of output files generated by the scenario",
                                "minItems": 1
                            }
                        },
                        "additionalProperties": false
                    },
                    {
                        "oneOf": [
                            {
                                "properties": {
                                    "type": {
                                        "enum": [
                                            "pbshm"
                                        ]
                                    },
                                    "files": {
                                        "items": {
                                            "$ref": "dataset.json#/definitions/schemaFile/properties/files/items"
                                        }
                                    }
                                }
                            },
                            {
                                "properties": {
                                    "type": {
                                        "enum": [
                                            "other"
                                        ]
                                    },
                                    "files": {
                                        "items": {
                                            "$ref": "dataset.json#/definitions/standardFile/properties/files/items"
                                        }
                                    }
                                }
                            }
                        ]
                    }
                ]
            },
            "minItems": 1
        }
    }
}